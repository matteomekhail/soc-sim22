<!--
  WCACE SOC Scenarios - Wazuh Manager Configuration
-->
<ossec_config>

  <global>
    <jsonout_output>yes</jsonout_output>
    <alerts_log>yes</alerts_log>
    <logall>no</logall>
    <logall_json>no</logall_json>
    <email_notification>no</email_notification>
  </global>

  <!-- Indexer connection -->
  <indexer>
    <enabled>yes</enabled>
    <hosts>
      <host>https://wazuh-indexer:9200</host>
    </hosts>
    <ssl>
      <certificate_authorities>
        <ca>/etc/ssl/root-ca.pem</ca>
      </certificate_authorities>
    </ssl>
  </indexer>

  <!-- Syslog input for scenario simulations -->
  <remote>
    <connection>syslog</connection>
    <port>514</port>
    <protocol>udp</protocol>
    <allowed-ips>0.0.0.0/0</allowed-ips>
  </remote>

  <remote>
    <connection>syslog</connection>
    <port>514</port>
    <protocol>tcp</protocol>
    <allowed-ips>0.0.0.0/0</allowed-ips>
  </remote>

  <!-- File Integrity Monitoring (for ransomware scenarios) -->
  <syscheck>
    <disabled>no</disabled>
    <frequency>300</frequency>
    <scan_on_start>yes</scan_on_start>
    <directories realtime="yes" report_changes="yes">/tmp/wcace-sandbox</directories>
    <directories realtime="yes" report_changes="yes">/var/ossec/data/fim-watch</directories>
    <alert_new_files>yes</alert_new_files>
  </syscheck>

  <!-- Log analysis -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
  </localfile>

  <localfile>
    <log_format>json</log_format>
    <location>/var/log/suricata/eve.json</location>
  </localfile>

  <!-- Authentication failure detection -->
  <ruleset>
    <decoder_dir>ruleset/decoders</decoder_dir>
    <rule_dir>ruleset/rules</rule_dir>
    <list>etc/lists/audit-keys</list>
  </ruleset>

  <!-- Active Response -->
  <active-response>
    <disabled>no</disabled>
  </active-response>

  <!-- API configuration -->
  <api>
    <https>yes</https>
  </api>

  <!-- Vulnerability detection -->
  <vulnerability-detector>
    <enabled>yes</enabled>
    <interval>5m</interval>
    <run_on_start>yes</run_on_start>
    <provider name="canonical">
      <enabled>yes</enabled>
      <os>focal</os>
      <update_interval>1h</update_interval>
    </provider>
  </vulnerability-detector>

</ossec_config>
