# Scenario 15: USB Malware Propagation

## Tier: 3 (Demo Only)

## Overview
An attacker uses infected USB drives (dropped in parking lot or mailed to employees) to deliver malware that propagates across the internal network once a device is connected.

## Why Demo Only
- Requires physical USB device interaction
- macOS USB access is sandboxed
- USB autorun is disabled by default on modern OS
- Malware propagation testing requires isolated lab environment

## MITRE ATT&CK Mapping

| Tactic | Technique | ID |
|--------|-----------|-----|
| Initial Access | Replication Through Removable Media | T1091 |
| Execution | User Execution | T1204 |
| Lateral Movement | Replication Through Removable Media | T1091 |
| Persistence | Boot or Logon Autostart Execution | T1547 |
| Defense Evasion | Obfuscated Files or Information | T1027 |

## Attack Flow

```
1. Preparation         → Create weaponized USB with autorun payload
2. Delivery            → Drop USB in target company parking lot
3. Execution           → Employee plugs in USB, payload executes
4. Persistence         → Malware installs autostart mechanism
5. Propagation         → Copies to other USB devices and network shares
6. C2 Communication    → Beacons back to attacker infrastructure
```

## Detection Indicators

### Endpoint
- USB device insertion event
- Autorun.inf execution attempt
- New executable launched from removable media
- File copy to/from removable media

### Network
- New device on network after USB insertion
- C2 beaconing from newly infected host
- SMB traffic to propagate to network shares
- Unusual DNS queries from endpoint

### Behavioral
- Multiple hosts executing same unknown binary
- Rapid file spread across network shares
- Registry modifications for persistence
- Scheduled tasks created by unsigned binary

## Sample Logs
Pre-generated logs in `logs/sample_logs/` simulate the USB malware lifecycle.

## SOC Response
See `respond/playbook.md` for the full response procedure.

## Tools for Further Study
- **USBGuard**: Linux USB device authorization
- **USB Rubber Ducky**: HID attack tool (for authorized testing)
- **Cuckoo Sandbox**: Malware analysis sandbox
- **YARA**: Malware identification and classification
