{
  "scenario": "22-api-vulnerability-exploitation",
  "description": "Expected alerts from API vulnerability exploitation simulation",
  "expected_alerts": [
    {
      "source": "suricata",
      "sid": 9220001,
      "description": "API IDOR - Sequential user ID enumeration",
      "min_count": 1,
      "severity": "high"
    },
    {
      "source": "suricata",
      "sid": 9220002,
      "description": "API Auth - JWT algorithm none bypass attempt",
      "min_count": 1,
      "severity": "critical"
    },
    {
      "source": "suricata",
      "sid": 9220003,
      "description": "API Auth - Brute force login attempts",
      "min_count": 1,
      "severity": "high"
    },
    {
      "source": "suricata",
      "sid": 9220005,
      "description": "API Mass Assignment - Role injection in registration",
      "min_count": 1,
      "severity": "high"
    },
    {
      "source": "suricata",
      "sid": 9220006,
      "description": "API SQLi - UNION SELECT in query parameter",
      "min_count": 2,
      "severity": "critical"
    },
    {
      "source": "suricata",
      "sid": 9220008,
      "description": "API Attack Tool - Suspicious user agent",
      "min_count": 1,
      "severity": "high"
    },
    {
      "source": "wazuh",
      "rule_id": 100801,
      "description": "API IDOR - Sequential user ID enumeration",
      "min_count": 1,
      "severity": "high"
    },
    {
      "source": "wazuh",
      "rule_id": 100802,
      "description": "API Auth Bypass - JWT algorithm manipulation",
      "min_count": 1,
      "severity": "critical"
    },
    {
      "source": "wazuh",
      "rule_id": 100803,
      "description": "API Brute Force - Multiple failed login attempts",
      "min_count": 1,
      "severity": "high"
    },
    {
      "source": "wazuh",
      "rule_id": 100806,
      "description": "API SQL Injection - UNION SELECT in query parameter",
      "min_count": 2,
      "severity": "critical"
    },
    {
      "source": "wazuh",
      "rule_id": 100807,
      "description": "Active API attack campaign - Multiple vectors detected",
      "min_count": 1,
      "severity": "critical"
    }
  ]
}
